<script setup lang="ts">
import mermaid from 'mermaid';
const { t } = useI18n();

const features = [
    {
        description: t('how_it_works.details.step_1'),
    },
    {
        description: t('how_it_works.details.step_2'),
    },
    {
        description: t('how_it_works.details.step_3'),
    },
    {
        description: t('how_it_works.details.step_4'),
    },
    {
        description: t('how_it_works.details.step_5'),
    },
    {
        description: t('how_it_works.details.step_6'),
    },
    {
        description: t('how_it_works.details.step_7'),
    },
];

onMounted(() => {
    mermaid.init(undefined, '.mermaid');
});
</script>

<template>
    <section id="how-it-works" class="section">
        <UContainer>
            <ULandingSection
                :title="t('how_it_works.title')"
                :description="t('how_it_works.description')"
                :features="features"
                align="right"
                :ui="{ wrapper: 'py-10 sm:py-10' }"
            >
                <div class="mermaid">
                    graph TD; A[ğŸ‘¤
                    {{ t('how_it_works.graphql.user_request') }}] -->|ğŸ“©
                    {{ t('how_it_works.graphql.cache_check') }}| B[ğŸŒ GraphQL
                    API]; B -->|ğŸ›‘ {{ t('how_it_works.graphql.cache_check') }}|
                    D[âš¡ Redis]; D -->|âœ…
                    {{ t('how_it_works.graphql.cache_found') }}| B; D -->|âŒ
                    {{ t('how_it_works.graphql.cache_miss') }}| E[ğŸ”
                    Sora-Ğ¿Ğ°Ñ€ÑĞµÑ€]; E -->|ğŸ›‘
                    {{ t('how_it_works.graphql.cache_check') }}| D; D -->|âœ…
                    {{ t('how_it_works.graphql.cache_found') }}| E; E -->|ğŸ’¾
                    {{ t('how_it_works.graphql.database_check') }}| H[ğŸ—„ï¸ MySQL /
                    MongoDB]; H -->|âœ…
                    {{ t('how_it_works.graphql.database_found') }}| E; H -->|âŒ
                    {{ t('how_it_works.graphql.database_miss') }}| F[ğŸŒ
                    MyAnimeList API]; F -->|ğŸ“¨
                    {{ t('how_it_works.graphql.api_request') }}| G[ğŸ› ï¸
                    {{ t('how_it_works.graphql.data_processing') }}]; G -->|ğŸ’¾
                    {{ t('how_it_works.graphql.save_data') }}| H & D; G -->|ğŸš€
                    {{ t('how_it_works.graphql.send_data') }}| E; E -->|ğŸ“¤
                    {{ t('how_it_works.graphql.send_data') }}| B; B -->|ğŸ“¤
                    {{ t('how_it_works.graphql.user_request') }}| A;
                </div>
            </ULandingSection>
        </UContainer>
    </section>
</template>
